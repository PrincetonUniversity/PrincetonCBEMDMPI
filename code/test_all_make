LDFLAGS = -lm

MPICXX=mpic++

MPICXXFLAGS = -O3 -lstdc++ -Wno-deprecated -g -Wall

GTEST_HEADERS = ../gtest-1.6.0/include/gtest/*.h \
	      ../gtest-1.6.0/include/gtest/internal/*.h

GTESTFLAGS = -I../gtest-1.6.0/include -lpthread

all : test_all

test_all : test_all.o system.o domain_decomp.o misc.o integrator.o interaction.o atom.o ../gtest-1.6.0/make/gtest_main.a
	$(MPICXX) $(MPICXXFLAGS) $(GTESTFLAGS) -o $@ $^

test_all.o : test_all.cc $(GTEST_HEADERS)
	$(MPICXX) $(MPICXXFLAGS) $(GTESTFLAGS) -c $<

#domain_decomp.o : domain_decomp.cc $(GTEST_HEADERS)
#	g++ -I../gtest-1.6.0/include -pthread -g -O3 -Wall -c $<

%.o : %.cpp
	$(MPICXX) $(MPICXXFLAGS) -c $<

clean :
	rm *.o test_all
	rm .depend