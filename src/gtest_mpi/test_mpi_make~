LDFLAGS = -lm

MPICXX=mpic++

MPICXXFLAGS = -O3 -lstdc++ -Wno-deprecated -g

GTEST_HEADERS = ../gtest-1.6.0/include/gtest/*.h \
	      ../gtest-1.6.0/include/gtest/internal/*.h

GTESTFLAGS = -I../gtest-1.6.0/include -lpthread

all : test_mpi

test_mpi : test_mpi.o system.o integrator.o domain_decomp.o misc.o interaction.o atom.o force_calc.o gtest_mpi.o ../gtest-1.6.0/make/gtest_main.a
	$(MPICXX) $(MPICXXFLAGS) $(GTESTFLAGS) -o $@ $^

test_mpi.o : test_mpi.cpp $(GTEST_HEADERS)
	$(MPICXX) $(MPICXXFLAGS) $(GTESTFLAGS) -c $<

%.o : %.cpp
	$(MPICXX) $(MPICXXFLAGS) -c $<

clean :
	$(RM) *.o test_all
	$(RM) .depend